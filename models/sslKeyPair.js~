var fs = require('fs');
var createCertSync = require('../helpers/createCertSync');
const KEYFILE = '../data/sslKeys.json';

/**
 * SSL key pair data model
 * @module models/SslKeyPair
 */

function SslKeyPair(name, opts) {
  this.pair = createCertSync(opts);
  this.name = name;
}

exports.createSync = createSync;
exports.getSync = getSync;

function writeKeys(obj) {
  fs.writeFileSync(__dirname + '/' + KEYFILE, JSON.stringify(obj, null, 2));
}
function readKeys() {
  return require(KEYFILE);
}



/**
 * createSync - description
 *
 * @param  {string} name description
 * @param  {string} opts description
 * @return {string}      description
 * @instance
 */
function createSync(name, opts) {
  var newPair = createCertSync(opts);
  var k = readKeys();
  k[name] = newPair;
  writeKeys(k);
  return newPair;
}

function getSync(name) {
  return readKeys()[name];
}
